# 本地运行指南

## 📋 前提条件

确保您的系统已安装：
- Ruby（版本 2.5.0 或更高）
- RubyGems
- GCC 和 Make

## 🚀 快速开始

### 步骤 1: 安装 Bundler

如果您还没有安装 Bundler，请运行：

```bash
gem install bundler
```

如果遇到权限问题，使用：

```bash
gem install bundler --user-install
```

然后需要将 gem 可执行文件路径添加到 PATH：

```bash
export PATH="$HOME/.gem/ruby/2.6.0/bin:$PATH"
```

或者永久添加到您的 shell 配置文件（~/.zshrc 或 ~/.bashrc）：

```bash
echo 'export PATH="$HOME/.gem/ruby/2.6.0/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

### 步骤 2: 安装依赖

```bash
cd /Users/wangwenxia/code/wenxia.github.io
bundle install
```

### 步骤 3: 启动本地服务器

**方法 1: 使用提供的脚本**（推荐）

```bash
bash run_server.sh
```

**方法 2: 手动启动**

```bash
bundle exec jekyll serve
```

**方法 3: 指定端口**

```bash
bundle exec jekyll serve --port 4000
```

**方法 4: 实时重载**

```bash
bundle exec jekyll serve --livereload
```

### 步骤 4: 在浏览器中访问

打开浏览器，访问：

```
http://localhost:4000
```

或

```
http://127.0.0.1:4000
```

## 🔧 常见问题

### 问题 1: bundler 版本不匹配

**错误信息**：
```
Could not find 'bundler' (2.2.19) required by your Gemfile.lock
```

**解决方案**：
```bash
gem install bundler:2.2.19 --user-install
```

### 问题 2: Ruby 版本过低

**错误信息**：
```
Your Ruby version is X.X.X, but your Gemfile specified ~> 2.5
```

**解决方案**：
升级 Ruby 到 2.5 或更高版本

**macOS**：
```bash
brew install ruby
```

**Ubuntu/Debian**：
```bash
sudo apt-get install ruby-full
```

### 问题 3: 端口已被占用

**错误信息**：
```
Address already in use - bind(2) for 127.0.0.1:4000
```

**解决方案**：
使用不同的端口
```bash
bundle exec jekyll serve --port 4001
```

### 问题 4: 权限错误

**错误信息**：
```
You don't have write permissions
```

**解决方案**：
安装到用户目录
```bash
bundle install --path vendor/bundle
```

### 问题 5: 缺少依赖

**错误信息**：
```
cannot load such file -- XXX
```

**解决方案**：
重新安装依赖
```bash
bundle clean --force
bundle install
```

## 📝 实时编辑

当本地服务器运行时：

1. **编辑内容**：修改 `_pages/about.md` 或其他文件
2. **保存文件**：Jekyll 会自动检测更改
3. **刷新浏览器**：查看更新（如果使用 `--livereload`，会自动刷新）

**注意**：修改 `_config.yml` 后需要重启服务器

## 🛑 停止服务器

在终端中按 `Ctrl + C`

## 🧪 测试建议

在本地测试以下内容：

### 1. 基本显示
- [ ] 页面标题显示正确
- [ ] 导航菜单工作正常
- [ ] 头像图片显示

### 2. 内容检查
- [ ] 个人简介显示完整
- [ ] 所有发表论文列表正确
- [ ] 研究项目显示正常
- [ ] 教育背景完整

### 3. 链接测试
- [ ] DOI 链接可以点击
- [ ] 邮箱链接正常
- [ ] ORCID 链接工作
- [ ] 导航菜单锚点跳转正确

### 4. 响应式测试
- [ ] 缩小浏览器窗口测试移动端视图
- [ ] 检查导航菜单在小屏幕上的显示
- [ ] 确保图片在移动端正确缩放

### 5. 性能测试
- [ ] 页面加载速度合理（< 3秒）
- [ ] 图片加载正常
- [ ] 没有控制台错误

## 📱 移动端测试

在浏览器中按 `F12` 打开开发者工具，然后：

1. 点击"Toggle device toolbar"图标（或按 `Ctrl+Shift+M`）
2. 选择不同的设备尺寸测试
3. 常见尺寸：
   - iPhone SE (375x667)
   - iPhone 12 Pro (390x844)
   - iPad (768x1024)
   - Desktop (1920x1080)

## 🐛 调试技巧

### 查看 Jekyll 详细输出

```bash
bundle exec jekyll serve --verbose
```

### 查看草稿

如果您有草稿文件，可以使用：
```bash
bundle exec jekyll serve --drafts
```

### 强制重新生成

```bash
bundle exec jekyll clean
bundle exec jekyll serve
```

### 检查配置

```bash
bundle exec jekyll doctor
```

## 📊 构建静态文件

如果只想生成静态文件而不启动服务器：

```bash
bundle exec jekyll build
```

生成的文件将在 `_site` 目录中

## 🔗 有用的命令

```bash
# 查看 Jekyll 版本
bundle exec jekyll --version

# 查看所有可用命令
bundle exec jekyll help

# 查看特定命令的帮助
bundle exec jekyll serve --help

# 更新依赖
bundle update

# 列出所有依赖
bundle list
```

## ✅ 准备部署

本地测试通过后：

1. **提交更改**
   ```bash
   git add .
   git commit -m "测试通过，准备部署"
   ```

2. **推送到 GitHub**
   ```bash
   git push
   ```

3. **等待 GitHub Pages 构建**
   - 访问仓库的 Actions 标签
   - 查看构建状态
   - 通常需要 2-5 分钟

4. **访问您的网站**
   ```
   https://YOUR_USERNAME.github.io
   ```

## 🆘 仍然有问题？

如果您遇到其他问题：

1. 查看 [Jekyll 文档](https://jekyllrb.com/docs/)
2. 查看 [AcadHomepage Issues](https://github.com/RayeRen/acad-homepage.github.io/issues)
3. 搜索 Stack Overflow
4. 检查 Ruby 和 Jekyll 版本兼容性

## 📚 相关文档

- `QUICK_START.md` - 快速部署指南
- `DEPLOYMENT_CN.md` - 完整部署说明
- `部署检查清单.md` - 部署前检查清单

---

**祝您本地测试顺利！** 🚀
